/*
[Module Metadata]
AUTHOR = Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES = Get a listing of applications and associated data (app name, executable name, bundle ID, app version, app type and deletion date/status). Not really a log per se, but a good listing of application information.
App Types: 1 = 'Background iOS Service', 3 = iOS Native Apps, 4 = 3rd Party Apps


[Database Metadata]
DATABASE=CurrentPowerlog.PLSQL
PLATFORM=IOS
VERSIONS=9,10,11,12,13

[Query Metadata]
QUERY_NAME=powerlog_app_info
ACTIVITY=App Info
KEY_TIMESTAMP=TIMESTAMP

[SQL Query 9,10,11,12,13]
*/
SELECT
	datetime(TIMESTAMP, 'UNIXEPOCH') AS TIMESTAMP,
	APPNAME AS 'APP NAME',
	APPEXECUTABLE AS 'APP EXECUTABLE NAME',
	APPBUNDLEID AS 'BUNDLE ID',
	APPBUILDVERSION AS 'APP BUILD VERSION',
	APPBUNDLEVERSION AS 'APP BUNDLE VERSION',
	APPTYPE AS 'APP TYPE',
	CASE APPDELETEDDATE
		WHEN 0 THEN 'NOT DELETED'
		ELSE datetime( APPDELETEDDATE, 'UNIXEPOCH' )
	END 'APP DELETED DATE',
	ID AS 'PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS TABLE ID'

FROM
	PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS


-- [SQL Query 10]
SELECT

	datetime( TIMESTAMP, 'UNIXEPOCH' ) AS TIMESTAMP,
	APPNAME AS 'APP NAME',
	APPEXECUTABLE AS 'APP EXECUTABLE NAME',
	APPBUNDLEID AS 'BUNDLE ID',
	APPBUILDVERSION AS 'APP BUILD VERSION',
	APPBUNDLEVERSION AS 'APP BUNDLE VERSION',

	CASE APPDELETEDDATE
		WHEN 0 THEN 'NOT DELETED'
		ELSE datetime( APPDELETEDDATE, 'UNIXEPOCH' )
	END 'APP DELETED DATE',

	ID AS 'PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS TABLE ID'

FROM PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS



-- [SQL Query 9]
SELECT

	datetime(TIMESTAMP, 'UNIXEPOCH' ) AS TIMESTAMP,
	APPNAME AS 'APP NAME',
	APPBUNDLEID AS 'BUNDLE ID',

	CASE APPDELETEDDATE
		WHEN 0 THEN 'NOT DELETED'
		ELSE datetime(APPDELETEDDATE, 'UNIXEPOCH' )
	END 'APP DELETED DATE',

	ID AS 'PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS TABLE ID'


FROM PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS
